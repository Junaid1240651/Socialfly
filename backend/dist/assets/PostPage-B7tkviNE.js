import{j as s,F as t,T as n,d as m,Y as D,e as S,u as b,Z as z,r as I,S as _,L as v,W as h,B as A,a as C,b as p,s as j}from"./index-JVrb99rO.js";import{f as N,D as E,A as T}from"./formatDistanceToNow-D_iz8mLG.js";import{D as d}from"./chunk-W7WUSNWJ-DB38mfw_.js";import{A as f}from"./chunk-V7PAE35Z-D2UZjn2e.js";import{u as k}from"./useGetUserProfile-BsM4RWpm.js";import"./chunk-JQMJHPZH-BRDday_i.js";const B=({reply:i,lastReply:o})=>s.jsxs(s.Fragment,{children:[s.jsxs(t,{gap:4,py:2,my:2,w:"full",children:[s.jsx(f,{src:i.userProfilePic,size:"sm"}),s.jsxs(t,{gap:1,w:"full",flexDirection:"column",children:[s.jsx(t,{w:"full",justifyContent:"space-between",alignItems:"center",children:s.jsx(n,{fontSize:"sm",fontWeight:"bold",children:i.userName})}),s.jsx(n,{children:i.text})]})]}),o?null:s.jsx(d,{})]}),J=()=>{const i=m(e=>e.user.userInfo),{user:o,loading:g}=k(),{id:x}=D(),a=m(e=>e.posts.setPosts),u=S(),r=a[0],l=b(),w=z(),y=async e=>{try{if(e.preventDefault(),!window.confirm("Are you sure you want to delete this post?"))return;await p.delete("/api/posts/"+r._id),l("Success","Post deleted","success"),w(`/${o.userName}`),u(j(a.filter(c=>c._id!==a._id)))}catch(c){l("Error",c.response.data.error,"error")}},P=async()=>{try{const e=await p(`/api/posts/${x}`);u(j([e.data]))}catch(e){l("Error",e.response.data.error,"error")}};return I.useEffect(()=>{P()},[x]),!o&&g?s.jsx(t,{justifyContent:"center",children:s.jsx(_,{size:"xl"})}):!r||!o?null:s.jsxs(v,{to:`/${o.userName}`,children:[s.jsxs(t,{children:[s.jsxs(t,{w:"full",alignItems:"center",gap:3,children:[s.jsx(f,{src:o.profilePic,size:"md",name:"Junaid Khan"}),s.jsxs(t,{alignItems:"center",children:[s.jsx(n,{fontSize:"sm",fontWeight:"bold",children:o.userName}),s.jsx(h,{src:"/verified.png",w:"4",h:4,ml:4})]})]}),s.jsxs(t,{gap:4,alignItems:"center",children:[s.jsxs(n,{fontSize:"xs",width:36,textAlign:"right",color:"gray.light",children:[N(new Date(r.createdAt))," ago"]}),(i==null?void 0:i._id)===o._id&&s.jsx(E,{size:20,cursor:"pointer",onClick:y})]})]}),s.jsx(n,{my:3,children:r.text}),r.img&&s.jsx(A,{borderRadius:6,overflow:"hidden",border:"1px solid",borderColor:"gray.light",children:s.jsx(h,{src:r.img,w:"full"})}),s.jsx(t,{gap:3,my:3,children:s.jsx(T,{post:r})}),s.jsx(d,{my:4}),s.jsxs(t,{justifyContent:"space-between",children:[s.jsxs(t,{gap:2,alignItems:"center",children:[s.jsx(n,{fontSize:"2xl",children:"ğŸ‘‹"}),s.jsx(n,{color:"gray.light",children:"Get the app to like, reply and post."})]}),s.jsx(C,{children:"Get"})]}),s.jsx(d,{my:4}),r.replies.map(e=>s.jsx(B,{reply:e,lastReply:e._id===r.replies[r.replies.length-1]._id},e._id))]})};export{J as default};
